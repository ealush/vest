'use strict';(function(w,u){"object"===typeof exports&&"undefined"!==typeof module?module.exports=u():"function"===typeof define&&define.amd?define(u):(w=w||self,w.vest=u())})(this,function(){function w(d,a){return a={exports:{}},d(a,a.exports),a.exports}function u(d){"@babel/helpers - typeof";u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};
return u(d)}function p(d,a,b){a in d?Object.defineProperty(d,a,{value:b,enumerable:!0,configurable:!0,writable:!0}):d[a]=b;return d}function q(){q=Object.assign||function(d){for(var a=1;a<arguments.length;a++){var b=arguments[a],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c])}return d};return q.apply(this,arguments)}function M(d,a){var b=Object.keys(d);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(d);a&&(c=c.filter(function(a){return Object.getOwnPropertyDescriptor(d,
a).enumerable}));b.push.apply(b,c)}return b}function k(d){for(var a=1;a<arguments.length;a++){var b=null!=arguments[a]?arguments[a]:{};a%2?M(Object(b),!0).forEach(function(a){p(d,a,b[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(b)):M(Object(b)).forEach(function(a){Object.defineProperty(d,a,Object.getOwnPropertyDescriptor(b,a))})}return d}function H(d,a){var b=Array.isArray(d)?d:void 0;if(!b)if("undefined"!==typeof Symbol&&Symbol.iterator in Object(d)){b=
[];var c=!0,e=!1,f=void 0;try{for(var g=d[Symbol.iterator](),v;!(c=(v=g.next()).done)&&(b.push(v.value),!a||b.length!==a);c=!0);}catch(ba){e=!0,f=ba}finally{try{if(!c&&null!=g["return"])g["return"]()}finally{if(e)throw f;}}}else b=void 0;if(!(d=b||N(d,a)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return d}function n(d){var a=Array.isArray(d)?I(d):void 0;a||(a="undefined"!==typeof Symbol&&
Symbol.iterator in Object(d)?Array.from(d):void 0);if(!(d=a||N(d)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return d}function N(d,a){if(d){if("string"===typeof d)return I(d,a);var b=Object.prototype.toString.call(d).slice(8,-1);"Object"===b&&d.constructor&&(b=d.constructor.name);if("Map"===b||"Set"===b)return Array.from(d);if("Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return I(d,
a)}}function I(d,a){if(null==a||a>d.length)a=d.length;for(var b=0,c=Array(a);b<a;b++)c[b]=d[b];return c}function z(d){if(h.use().ctx)return q(h.use().ctx,d);h.use().ctx=this;q(this,d);return this}function E(d,a,b,c){q(this,{suiteId:d,testFn:c,fieldName:a,statement:b,isWarning:!1,failed:!1,id:O()})}var P="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},ca=w(function(d,a){!function(a,c){d.exports=c()}(P,
function(){var a=function(a){if("function"==typeof a)try{return c(a())}catch(f){return!1}return c(a)},c=function(a){return!!Array.isArray(a)||0!=a&&!!a};return function(){for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return c.some(a)}})}),Q=w(function(d,a){!function(a,c){d.exports=c()}(P,function(){function a(){return(a=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c,d=arguments[b];for(c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}return a}).apply(this,
arguments)}function c(a){return!!Array.isArray(a)}function d(a){return"number"==typeof a}function f(a){return"string"==typeof a}function g(a,b){return b instanceof RegExp?b.test(a):"string"==typeof b&&(new RegExp(b)).test(a)}function v(a,b){return!!(Array.isArray(b)&&["string","number","boolean"].includes(u(a))||"string"==typeof b&&"string"==typeof a)&&b.includes(a)}function h(a,b){return a===b}function l(a){return!(isNaN(parseFloat(a))||isNaN(Number(a))||!isFinite(a))}function k(a,b){return l(a)&&
l(b)&&Number(a)===Number(b)}function m(a){return!a||(l(a)?0===a:Object.prototype.hasOwnProperty.call(a,"length")?0===a.length:"object"!=u(a)||0===Object.keys(a).length)}function n(a,b){return l(a)&&l(b)&&Number(a)>Number(b)}function p(a,b){return l(a)&&l(b)&&Number(a)>=Number(b)}function q(a,b){return l(a)&&l(b)&&Number(a)<Number(b)}function r(a,b){return l(a)&&l(b)&&Number(a)<=Number(b)}function t(a,b){return a.length===b}function w(a){return!!a}function x(a,b){if("function"==typeof a){for(var c=
arguments.length,d=Array(2<c?c-2:0),e=2;e<c;e++)d[e-2]=arguments[e];if(!0!==a.apply(void 0,[b].concat(d)))throw Error("[Enforce]: invalid "+u(b)+" value");}}function y(b){void 0===b&&(b={});var c=a({},C,{},b);if("function"==typeof B.Proxy)return function(a){var b=new Proxy(c,{get:function(c,d){if(z(c,d))return function(){for(var e=arguments.length,f=Array(e),g=0;g<e;g++)f[g]=arguments[g];return x.apply(void 0,[c[d],a].concat(f)),b}}});return b};var d=Object.keys(c);return function(b){return d.reduce(function(d,
e){var f;return a(d,a({},z(c,e)&&((f={})[e]=function(){for(var a=arguments.length,f=Array(a),g=0;g<a;g++)f[g]=arguments[g];return x.apply(void 0,[c[e],b].concat(f)),d},f)))},{})}}var z=function(a,b){return(a=Object.prototype.hasOwnProperty.call(a,b)&&"function"==typeof a[b])||function(a){setTimeout(function(){throw Error("[enforce]: "+a);})}('Rule "'+b+'" was not found in rules object. Make sure you typed it correctly.'),a},B=Function("return this")();c.negativeForm="isNotArray";d.negativeForm="isNotNumber";
f.negativeForm="isNotString";g.negativeForm="notMatches";v.negativeForm="notInside";h.negativeForm="notEquals";l.negativeForm="isNotNumeric";k.negativeForm="numberNotEquals";m.negativeForm="isNotEmpty";n.alias="gt";p.alias="gte";q.alias="lt";r.alias="lte";t.negativeForm="lengthNotEquals";w.negativeForm="isFalsy";var C=function(a){var b,c=function(b){var c=a[b].negativeForm,d=a[b].alias;c&&(a[c]=function(){return!a[b].apply(a,arguments)});d&&(a[d]=a[b])};for(b in a)c(b);return a}({isArray:c,isNumber:d,
isString:f,matches:g,inside:v,equals:h,numberEquals:k,isNumeric:l,isEmpty:m,greaterThan:n,greaterThanOrEquals:p,lessThan:q,lessThanOrEquals:r,longerThan:function(a,b){return a.length>b},longerThanOrEquals:function(a,b){return a.length>=b},shorterThan:function(a,b){return a.length<b},shorterThanOrEquals:function(a,b){return a.length<=b},lengthEquals:t,isOdd:function(a){return!!l(a)&&0!=a%2},isEven:function(a){return!!l(a)&&0==a%2},isTruthy:w}),A=new y;return A.Enforce=y,A})}),x=Function("return this")(),
r=function(d){throw new (1<arguments.length&&void 0!==arguments[1]?arguments[1]:Error)("[Vest]: ".concat(d));},y=Symbol["for"]("VEST#".concat("1")),da=function(){for(var d=arguments.length,a=Array(d),b=0;b<d;b++)a[b]=arguments[b];r("Multiple versions of Vest detected: (".concat(a.join(),").\n    Most features should work regularly, but for optimal feature compatibility, you should have all running instances use the same version."))},R=function(d){return d?x[y][d]:x[y]},h={use:R,set:function(d,a){return x[y][d]=
a},useContext:function(){return R().ctx},register:function(d,a){var b=x[y];b?b.VERSION!==d.VERSION&&da(d.VERSION,b.VERSION):x[y]=d;a();return x[y]}};z.prototype.setCurrentTest=function(d){this.currentTest=d};z.prototype.removeCurrentTest=function(){delete this.currentTest};z.clear=function(){h.use().ctx=null};var J=function(d,a){var b=d;h.useContext()!==d&&(b=new z(d));d=a(b);z.clear();return d},ea=function b(a){if(!a)return a;if(Array.isArray(a))return a.map(b);if("object"===u(a)){a=k({},a);for(var c in a)a[c]=
b(a[c])}return a},B=function(a,b){a=[].concat(n(a.pending),n(a.lagging));return a.length?b?a.some(function(a){return a.fieldName===b}):!!a.length:!1},C=Symbol("vestState"),A=Symbol("vestSuites"),F=Symbol("canceledTests"),D=function(a){return a?h.use(C)[a]:h.use(C)},S=function(a){h.set(C,a(D()));return D()},K=function(a){S(function(b){b[A]=a(b[A]);return b});return D(A)},m=function(a){return D(A)[a]},t=function(a,b){var c,e=null!==(c=m(a))&&void 0!==c?c:[];e=H(e,2);c=e[0];b=b(c,e[1]);return b===c?
c:m(a)[0]=b},T=function(a,b,c){var e,f;return c?!!(null===a||void 0===a?0:null===(e=a.tests)||void 0===e?0:null===(f=e[c])||void 0===f?0:f[b]):!(null===a||void 0===a||!a[b])},U=function(a,b,c){var e,f,g;if(!c){c={};for(var v in a.tests){var h,l;(null===(h=a.tests)||void 0===h?0:h[v])&&(null===(l=a.tests)||void 0===l?0:l[v][b])&&(c[v]=a.tests[v][b])}return c}return null!==(e=null===(f=a.tests)||void 0===f?void 0:null===(g=f[c])||void 0===g?void 0:g[b])&&void 0!==e?e:[]},fa=function(a){for(var b=arguments.length,
c=Array(1<b?b-1:0),e=1;e<b;e++)c[e-1]=arguments[e];b=c.length;var f=c[b-1],g=c[b-2];c=G(a);b=g&&!a.tests[g];if("function"!==typeof f||b)return c;var h=function(){return f(G(a,{draft:!0}))};b=g&&!B(a,g);e=!B(a);if(b||e)return h(),c;t(a.suiteId,function(a){if(g){var b;a.fieldCallbacks[g]=(b=[]).concat.apply(b,n(a.fieldCallbacks[g]||[]).concat([h]))}else a.doneCallbacks.push(h);return a});return c},G=function(a){var b,c,e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).draft;return b=(c=
{errorCount:a.errorCount,warnCount:a.warnCount,tests:a.tests,name:a.name},ea(c)),Object.defineProperties(b,[["hasErrors",T.bind(null,a,"errorCount")],["hasWarnings",T.bind(null,a,"warnCount")],["getErrors",U.bind(null,a,"errors")],["getWarnings",U.bind(null,a,"warnings")]].concat(e?[]:[["done",fa.bind(null,a)]]).reduce(function(a,b){b=H(b,2);return q(a,p({},b[0],{value:b[1],writeable:!0,configurable:!0,enumerable:!0}))},{}))},ha=function(){var a=h.useContext(),b=a.name,c=a.suiteId,e=m(c);a=[];if(e){var f=
H(e,1)[0];a=[].concat(n(f.lagging),n(f.pending));f.pending=null;f.lagging=null}else e=K(function(a){a[c]=[];return a})[c];b=k(k({},{name:b,suiteId:c,pending:[],lagging:[],skipped:{},doneCallbacks:[],fieldCallbacks:{},tests:{},exclusive:{},errorCount:0,warnCount:0}),{},{lagging:a});e.unshift(b);e.length=2;K(function(a){return q(a,p({},c,e))})},ia=function(a,b){t(a,function(a){if(a.skipped[b])return a;a=k({},a);a.skipped[b]=!0;return a})},ja=function(a){t(a,function(a,c){if(!c)return a;var b=k({},a),
f;for(f in a.skipped)c.tests[f]&&!a.tests[f]&&(b.tests[f]=k({},c.tests[f]),b.errorCount+=c.tests[f].errorCount,b.warnCount+=c.tests[f].warnCount);return b})},L=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];b&&b.length&&S(function(a){return k(k({},a),{},p({},F,b.reduce(function(a,b){return q(a,p({},b.id,!0))},a[F])))})},V=function(a){a||r("`vest.reset` must be called with suiteId.");var b=m(a)[0];b&&(L.apply(void 0,n(b.pending||[])),L.apply(void 0,n(b.lagging||[])),
K(function(b){delete b[a];return b}))},W=function(a){var b=m(a)[0];B(b)||V(a)},ka=function(a,b){var c=b.fieldName,e=m(a)[0].lagging.reduce(function(a,b){var e=a.lagging;a=a.canceled;b.fieldName!==c?e.push(b):a.push(b);return{lagging:e,canceled:a}},{lagging:[],canceled:[]}),f=e.lagging;e=e.canceled;t(a,function(a){return k(k({},a),{},{lagging:f,pending:a.pending.concat(b)})});L.apply(void 0,n(e))},la=function(a){t(a.suiteId,function(b){return k(k({},b),{},{pending:b.pending.filter(function(b){return b!==
a}),lagging:b.lagging.filter(function(b){return b!==a})})})},X=function(a,b){if("function"===typeof b){var c=h.useContext();c.setCurrentTest(a);a=b();c.removeCurrentTest();return a}},ma=function(a,b){a=m(a)[0];b&&!B(a,b)&&Array.isArray(a.fieldCallbacks[b])&&a.fieldCallbacks[b].forEach(function(a){return a()});B(a)||a.doneCallbacks.forEach(function(a){return a()})},na=function(a){var b=a.testFn,c=a.statement,e=a.fieldName,f=a.id,g=a.suiteId,k=h.useContext().operationMode,m=function(b){D(F)[f]||("function"===
typeof b&&b(),la(a),ma(g,e),"STATELESS"===k&&W(g))},l=function(b){m(function(){a.statement="string"===typeof b?b:c;a.fail()})};X(a,function(){try{b.then(m,l)}catch(ra){l()}})},Y=function(a,b){return"string"!==typeof a?r("Suite initialization error. Expected name to be a string.",TypeError):"function"!==typeof b?r("Suite initialization error. Expected tests to be a function.",TypeError):function(){var c,e=null!==(c=h.useContext())&&void 0!==c?c:{name:a,tests:b,suiteId:a,operationMode:"STATEFUL"};return J(e,
function(a){ha();a=a.suiteId;b();ja(a);n(m(a)[0].pending).forEach(na);return G(m(a)[0])})}},Z=function(a,b){var c=h.useContext();b&&(void 0===(null===c||void 0===c?void 0:c.suiteId)?r("".concat(a," ").concat("hook called outside of a running suite.")):t(c.suiteId,function(c){var e=k({},c);[].concat(b).forEach(function(b){"string"===typeof b&&(e.exclusive[a]=e.exclusive[a]||{},e.exclusive[a][b]=!0)});return e}))},oa=function(a){var b,c,e,f=h.useContext();if(void 0===(null===f||void 0===f?void 0:f.suiteId))return!1;
f=m(f.suiteId)[0];if(null===(b=f.exclusive)||void 0===b?0:null===(c=b.skip)||void 0===c?0:c[a])return!0;if(null===(e=f.exclusive)||void 0===e?0:e.only){var g;return(null===(g=f.exclusive.only)||void 0===g?0:g[a])?!1:!0}return!1},aa=Symbol("vestId"),O=function(){var a,b=null!==(a=h.use()[aa])&&void 0!==a?a:0;h.set(aa,b+1);return b.toString()};E.prototype.valueOf=function(){return!0!==this.failed};E.prototype.fail=function(){var a=this,b=this.fieldName,c=this.statement;if(this.isWarning){var e="warnings";
var f="warnCount"}else e="errors",f="errorCount";t(this.suiteId,function(g){if(!g.tests[a.fieldName])return g;var h=k({},g);h.tests[b][e]=g.tests[b][e]||[];c&&h.tests[b][e].push(c);h[f]++;h.tests[b][f]++;return h});this.failed=!0;return this};E.prototype.warn=function(){this.isWarning=!0;return this};var pa=function(a,b){t(a,function(a){return void 0!==a.tests[b]?a:k(k({},a),{},{tests:k(k({},a.tests),{},p({},b,{errorCount:0,warnCount:0}))})})},qa=function(a){return X(a,function(){try{var b=a.testFn.apply(a)}catch(c){b=
!1}!1===b&&a.fail();return b})};return h.register({Enforce:Q.Enforce,create:Y,VERSION:"1.0.10",any:ca,draft:function(){var a=h.useContext();if(void 0===(null===a||void 0===a?void 0:a.suiteId))r("draft hook called outside of a running suite.");else return a=m(a.suiteId)[0],G(a,{draft:!0})},enforce:Q,only:function(a){return Z("only",a)},runWithContext:J,skip:function(a){return Z("skip",a)},test:function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),e=1;e<b;e++)c[e-1]=arguments[e];e=c.length;b=c[e-
2];c=c[e-1];e=h.useContext();if(oa(a))return ia(e.suiteId,a);if("function"===typeof c)return c=new E(e.suiteId,a,b,c),pa(c.suiteId,c.fieldName),b=qa(c),"function"===typeof(null===b||void 0===b?void 0:b.then)&&(c.testFn=b,ka(c.suiteId,c)),c},validate:function(a,b){var c=O(),e=J({name:a,suiteId:c,operationMode:"STATELESS"},function(){var c=Y(a,b);if("function"===typeof c)return c()});W(c);return e},warn:function(){var a=h.useContext();a?a.currentTest?a.currentTest.warn():r("warn hook called outside of a test callback. It won't have an effect."):
r("warn hook called outside of a running suite.")},reset:V},function(){var a,b;h.set(C,null!==(a=h.use(C))&&void 0!==a?a:(b={},p(b,A,{}),p(b,F,{}),b))})})
