"use strict";!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).vest=e()}(this,(function(){function t(t,e){return t(e={exports:{}},e.exports),e.exports}function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(){return(n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function o(t){p.use().ctx?n(p.use().ctx,this):p.use().ctx=this,n(p.use().ctx,t)}function i(t,e,r,o){n(this,{ctx:t,testFn:o,fieldName:e,statement:r,isWarning:!1,failed:!1})}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var u=t((function(t,e){t.exports=function(){var t=function(t){if("function"==typeof t)try{return e(t())}catch(t){return!1}return e(t)},e=function(t){return!!Array.isArray(t)||0!=t&&!!t};return function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.some(t)}}()})),s=t((function(t,n){t.exports=function(){function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function n(t){return!!Array.isArray(t)}function r(t){return"number"==typeof t}function o(t){return"string"==typeof t}function i(t,e){return e instanceof RegExp?e.test(t):"string"==typeof e&&new RegExp(e).test(t)}function u(t,n){return!!(Array.isArray(n)&&["string","number","boolean"].includes(e(t))||"string"==typeof n&&"string"==typeof t)&&n.includes(t)}function s(t,e){return t===e}function a(t){return!(isNaN(parseFloat(t))||isNaN(Number(t))||!isFinite(t))}function c(t,e){return a(t)&&a(e)&&Number(t)===Number(e)}function f(t){return!t||(a(t)?0===t:Object.prototype.hasOwnProperty.call(t,"length")?0===t.length:"object"!=e(t)||0===Object.keys(t).length)}function l(t,e){return a(t)&&a(e)&&Number(t)>Number(e)}function p(t,e){return a(t)&&a(e)&&Number(t)>=Number(e)}function y(t,e){return a(t)&&a(e)&&Number(t)<Number(e)}function g(t,e){return a(t)&&a(e)&&Number(t)<=Number(e)}function h(t,e){return t.length===e}function d(t){return!!t}function m(t,n){if("function"==typeof t){for(var r=arguments.length,o=Array(2<r?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];if(!0!==t.apply(void 0,[n].concat(o)))throw Error("[Enforce]: invalid "+e(n)+" value")}}function v(e){void 0===e&&(e={});var n=t({},x,{},e);if("function"==typeof w.Proxy)return function(t){var e=new Proxy(n,{get:function(n,r){if(b(n,r))return function(){for(var o=arguments.length,i=Array(o),u=0;u<o;u++)i[u]=arguments[u];return m.apply(void 0,[n[r],t].concat(i)),e}}});return e};var r=Object.keys(n);return function(e){return r.reduce((function(r,o){var i;return t(r,t({},b(n,o)&&((i={})[o]=function(){for(var t=arguments.length,i=Array(t),u=0;u<t;u++)i[u]=arguments[u];return m.apply(void 0,[n[o],e].concat(i)),r},i)))}),{})}}var b=function(t,e){return(t=Object.prototype.hasOwnProperty.call(t,e)&&"function"==typeof t[e])||function(t){setTimeout((function(){throw Error("[enforce]: "+t)}))}('Rule "'+e+'" was not found in rules object. Make sure you typed it correctly.'),t},w=Function("return this")();n.negativeForm="isNotArray",r.negativeForm="isNotNumber",o.negativeForm="isNotString",i.negativeForm="notMatches",u.negativeForm="notInside",s.negativeForm="notEquals",a.negativeForm="isNotNumeric",c.negativeForm="numberNotEquals",f.negativeForm="isNotEmpty",l.alias="gt",p.alias="gte",y.alias="lt",g.alias="lte",h.negativeForm="lengthNotEquals",d.negativeForm="isFalsy";var x=function(t){var e,n=function(e){var n=t[e].negativeForm,r=t[e].alias;n&&(t[n]=function(){return!t[e].apply(t,arguments)}),r&&(t[r]=t[e])};for(e in t)n(e);return t}({isArray:n,isNumber:r,isString:o,matches:i,inside:u,equals:s,numberEquals:c,isNumeric:a,isEmpty:f,greaterThan:l,greaterThanOrEquals:p,lessThan:y,lessThanOrEquals:g,longerThan:function(t,e){return t.length>e},longerThanOrEquals:function(t,e){return t.length>=e},shorterThan:function(t,e){return t.length<e},shorterThanOrEquals:function(t,e){return t.length<=e},lengthEquals:h,isOdd:function(t){return!!a(t)&&0!=t%2},isEven:function(t){return!!a(t)&&0==t%2},isTruthy:d}),N=new v;return N.Enforce=v,N}()})),a=Function("return this")(),c=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Error;return setTimeout((function(){throw new e("[Vest]: ".concat(t))}))},f=Symbol.for("VEST#".concat("1")),l=function(){return a[f]},p={use:l,useContext:function(){return l().ctx},register:function(t){var e=a[f];return e?e.VERSION!==t.VERSION&&function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];c("Multiple versions of Vest detected: (".concat(e.join(),").\n    Most features should work regularly, but for optimal feature compatibility, you should have all running instances use the same version."))}(t.VERSION,e.VERSION):a[f]=t,a[f]}};o.prototype.setCurrentTest=function(t){this.currentTest=t},o.prototype.removeCurrentTest=function(){delete this.currentTest},o.clear=function(){p.use().ctx=null};var y=function(t,e){return new o(t),t=e(),o.clear(),t},g=function(t,e){var n=p.useContext();e&&(n?(n.exclusive=n.exclusive||{},[].concat(e).forEach((function(e){"string"==typeof e&&(n.exclusive[t]=n.exclusive[t]||{},n.exclusive[t][e]=!0)}))):c("".concat(t," ").concat("hook called outside of a running suite.")))};i.prototype.valueOf=function(){return!0!==this.failed},i.prototype.fail=function(){return this.ctx.result.markFailure({fieldName:this.fieldName,statement:this.statement,isWarning:this.isWarning}),this.failed=!0,this},i.prototype.warn=function(){return this.isWarning=!0,this};var h=function(t){var e=t.testFn,n=t.statement,r=t.ctx,o=function(){return r.result.markAsDone(t)},i=function(e){t.statement="string"==typeof e?e:n,t.fail(),o()};r.setCurrentTest(t);try{e.then(o,i)}catch(t){i()}r.removeCurrentTest()};return p.register({Enforce:s.Enforce,VERSION:"1.0.9",any:u,draft:function(){var t=p.useContext();if(t)return t.result.output;c("draft hook called outside of a running suite.")},enforce:s,only:function(t){return g("only",t)},runWithContext:y,skip:function(t){return g("skip",t)},test:function(t){for(var e,n,r=arguments.length,o=Array(1<r?r-1:0),u=1;u<r;u++)o[u-1]=arguments[u];if("string"==typeof o[0]?(e=o[0],n=o[1]):"function"==typeof o[0]&&(n=o[0]),"function"==typeof n){if(n=(e=new i(p.useContext(),t,e,n)).ctx,o=e.fieldName,r=!1,(u=p.useContext())&&u.exclusive&&(u.exclusive.skip&&u.exclusive.skip[o]||u.exclusive.only&&!u.exclusive.only[o]))n.result.addToSkipped(o);else{n.result.markTestRun(o),e.ctx.setCurrentTest(e);try{var s=e.testFn.apply(e)}catch(t){s=!1}e.ctx.removeCurrentTest(),!1===s&&e.fail(),s&&"function"==typeof s.then&&(r=!0,e.testFn=s),r&&n.result.setPending(e)}return e}},validate:function(t,e){if("string"!=typeof t)return c("Suite initialization error. Expected name to be a string.",TypeError);if("function"!=typeof e)return c("Suite initialization error. Expected tests to be a function.",TypeError);var n=function(t){var e=[],n=[],r={},o=!1,i=function(t){e=e.filter((function(e){return e!==t}))},u=function(t){return!!e.length&&(t?e.some((function(e){return e.fieldName===t})):!!e.length)},s=function(t){return t?Array.isArray(r[t])?r[t].forEach((function(t){return t(c)})):void 0:n.forEach((function(t){return t(c)}))},a=function(t){var e,n={};for(e in c.tests)c.tests[e]&&c.tests[e][t]&&(n[e]=c.tests[e][t]);return n},c={name:t,errorCount:0,warnCount:0,testCount:0,tests:{},skipped:[],tested:[]};return Object.defineProperties(c,{hasErrors:{value:function(t){return t?!(!c.tests[t]||!c.tests[t].errorCount):!!c.errorCount},writable:!0,configurable:!0,enumerable:!1},hasWarnings:{value:function(t){return t?!(!c.tests[t]||!c.tests[t].warnCount):!!c.warnCount},writable:!0,configurable:!0,enumerable:!1},getErrors:{value:function(t){return t?c.tests[t].errors?c.tests[t].errors:[]:a("errors")},writable:!0,configurable:!0,enumerable:!1},getWarnings:{value:function(t){return t?c.tests[t].warnings?c.tests[t].warnings:[]:a("warnings")},writable:!0,configurable:!0,enumerable:!1},done:{value:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return t=e[(i=e.length)-1],e=e[i-2],"function"!=typeof t?c:!o||e&&!u(e)?(t(c),c):(e?(r[e]=r[e]||[],r[e].push(t)):n.push(t),c)},writable:!0,configurable:!0,enumerable:!1},cancel:{value:function(){return c.canceled=!0,c},writable:!0,configurable:!0,enumerable:!1}}),{markTestRun:function(t){c.tests[t]||(c.tests[t]={testCount:0,errorCount:0,warnCount:0},c.tested.push(t)),c.tests[t].testCount++,c.testCount++},markFailure:function(t){var e=t.fieldName,n=t.statement;if(c.tests[e]){if(t.isWarning){t="warnings";var r="warnCount"}else t="errors",r="errorCount";c.tests[e][t]=c.tests[e][t]||[],n&&c.tests[e][t].push(n),c[r]++,c.tests[e][r]++}},setPending:function(t){o=!0,e.push(t)},addToSkipped:function(t){!c.skipped.includes(t)&&c.skipped.push(t)},markAsDone:function(t){c.canceled||(t&&(i(t),u(t.fieldName)||s(t.fieldName)),u()||s())},pending:e,output:c}}(t);return y({result:n},(function(){e();var t=n.pending,o=Array.isArray(t)?r(t):void 0;if(o||(o="undefined"!=typeof Symbol&&Symbol.iterator in Object(t)?Array.from(t):void 0),!o)t:{if(t){if("string"==typeof t){o=r(t,void 0);break t}if("Object"===(o=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o){o=Array.from(o);break t}if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)){o=r(t,void 0);break t}}o=void 0}if(!(t=o))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");t.forEach(h)})),n.output},warn:function(){var t=p.useContext();t?t.currentTest?t.currentTest.warn():c("warn hook called outside of a test callback. It won't have an effect."):c("warn hook called outside of a running suite.")}})}));
